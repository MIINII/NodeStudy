# ğŸ–¥ NODE.js

> ì‚¬ìš©ìì—ê²Œ ë°ì´í„°ë¥¼ íšŒì‹ í•˜ëŠ” ì½”ë“œë¥¼ ì„œë²„ì—ì„œ ì‘ì„±í•´ì„œ í´ë¼ì´ì–¸íŠ¸ê°€ ì‚¬ìš©í•˜ê²Œ

## :mouse_trap: ë…¸ë“œì˜ ì‚¬ìš©ì²˜

1. ğŸŒŸ ì„œë²„ ìš´ìš© : ì„œë²„ ìì²´ë¥¼ ìŠ¤ìŠ¤ë¡œ ì‘ì„±í•˜ê²Œ..? ì½”ë“œê°€ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•´ì„œ ë‹¤ë¥¸ ì½”ë“œë¡œ ë³´ë‚´ì¤€
   ë‹¤.
2. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìš´ìš© : ìš”ì²­ë°›ì€ ë°ì´í„° ì²˜ë¦¬, ë°ì´í„°ë² ì´ìŠ¤ í™œìš© ë“±...
3. ì‘ë‹µ ì‚¬ì´ë“œë„ ì²˜ë¦¬ : ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ë§Œì´ ì•„ë‹ˆë¼ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°ì´í„°ë¥¼ íšŒì‹ í• ìˆ˜ë„ ìˆìŒ

```js
//ê¸°ë³¸ ì‚¬ìš© ë°©ë²•
const fs = require('fs'); // require : ë…¸ë“œ ì½”ì–´ ëª¨ë“ˆ ë¶ˆëŸ¬ì˜¤ê¸°, fs:FileSystem

fs.writeFileSync('hello.txt', 'hello from Node.js'); // writeFileSync : í•˜ë“œ ë“œë¼ì´ë¸Œì— íŒŒì¼ì„ ìƒì„±
```

## :pen: ë…¸ë“œ ê°•ì˜ ìˆœì„œ

- [#3 | ê¸°ë³¸ê°œë…ì´í•´](https://kmooc.udemy.com/course/nodejs-mvc-rest-apis-graphql-deno/learn/lecture/30288790#overview)
- #5 | express.jsì‘ì—…
- #6 | ejsë¶€ë¶„

### :blue_book: REPL(Read, Eval, Print, Loop)

- Read : ì‚¬ìš©ì ì…ë ¥ê°’ì„ ì½ê¸°
- Evaluate : ì‚¬ìš©ì ì…ë ¥ê°’ì„ í‰ê°€
- Print : ê²°ê³¼ê°’ ì¶œë ¥
- Loop : ìƒˆë¡œìš´ ì…ë ¥ê°’ ê¸°ë‹¤ë¦¼

---

# ğŸ’ 3ê°• : ë…¸ë“œ ê¸°ë³¸ ê°œë… ì´í•´

## ğŸ•¸ ì›¹ ì‘ë™ ë°©ì‹

ì‘ë‹µê³¼ ìš”ì²­ì€ ëª¨ë‘ `header`ë¥¼ ê°€ì§€ê³  ìˆë‹¤.

- `header` : ì‘ë‹µ, ìš”ì²­ì— ì²¨ë¶€ë˜ëŠ” ë©”íƒ€ ë°ì´í„°ë¡œ ë‚´ìš©ì´ ë¬´ì—‡ì¸ì§€ ì•Œë ¤ì¤€ë‹¤
- HTTP / HTTPS : ìœ íš¨í•œ ìš”ì²­ì´ ì–´ë–¤í˜•íƒœë¥¼ ì§€ë‹ˆê³  ì–´ë–¤ ë°ì´í„°ê°€ ì „ì†¡ë˜ì–´ì•¼í• ì§€ ì •ì˜

## ğŸª› Node ì„œë²„ ìƒì„±í•´ë³´ê¸°

```jsx
// app.js
const http = require('http');

// CreateServer(requestListener?:(request : ë“¤ì–´ì˜¤ëŠ” ëª¨ë“  ìš”ì²­ì„ ì‹¤í–‰í•˜ëŠ” ê¸°ëŠ¥))
// ì„œë²„ë¥¼ ìƒì„±í• ë•Œ í•„ìš”í•œ ë©”ì„œë“œ -> ëª¨ë“  ìš”ì²­ì„ ë°›ì„ë•Œì—ëŠ” ì†Œê´„í˜¸ ì“°ì§€ë§ê±¸ì•„
// http.createServer(rqListener);
const server = http.createServer((req, res) => {
  console.log(req);
});

// listen(port, hostname) : Nodeê°€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë°”ë¡œ ì¢…ë£Œí•˜ì§€ì•Šê³  **ê³„ì† ì‹¤í–‰**ë˜ë©´ì„œ ë“£ë„ë¡ í•œë‹¤.
server.listen(3000);
```

`node app.js`

## â›‘ï¸ ì½”ì–´ ëª¨ë“ˆ

1. `http` -> ì„œë²„ë¥¼ ì¶œì‹œí•˜ê±°ë‚˜ ìš”ì²­ì„ ë³´ë‚´ëŠ”ê²ƒê³¼ ê°™ì€ ì‘ì—…ì— ë„ì›€, ì—¬ëŸ¬ ì„œë²„ê°„ì— ì†Œí†µ ê°€ëŠ¥
2. `https` -> ëª¨ë“  ì „ì†¡ ë°ì´í„°ê°€ ì•”í˜¸í™”ë˜ëŠ” SSL ì•”í˜¸í™” ì„œë²„ë¥¼ ì¶œì‹œí•˜ëŠ”ë° ë„ì›€
3. `fs` ->
4. `path`
5. `os`

## ğŸ›¼ ìš”ì²­ ê°ì²´ ë‹¤ë£¨ê¸°

```jsx
const server = http.createServer((req, res) => {
  console.log(req.url, req.method, req.headers);
});
```

## ğŸ“« ì‘ë‹µ ì „ì†¡

> `GET`ë©”ì„œë“œë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤

`setHeader(StringName, StringValue)` -> name í—¤ë”ì˜ ê°’ì„ Valueë¡œ ì§€ì •í•œë‹¤

```jsx
const server = http.createServer((req, res) => {
  console.log(req.url, req.method, req.headers);
  // process.exit(); // ëŒ€ê²Œ ì‚¬ìš©í•  ì¼ì´ ì—†ë‹¤~~

  // setHeader(String Name, String Value)
  res.setHeader('Content-Type', 'text/html');

  // write
  res.write('<html>');
  res.write('<head><title>My First Page</title></head>');
  res.write('<bode><h1>í—¬ë¡œ</h1></bode>');
  res.write('</html>');

  res.end(); // ì´ë°‘ìœ¼ë¡œ ì•„ë¬´ê²ƒë„ ì ìœ¼ë©´ ì•ˆëœë‹¤
});
```

## ğŸ Router ìš”ì²­

- `writeFileSync`
- `setHeader('ìœ„ì¹˜ì§€ì •', ë¸Œë¼ìš°ì €ê°€ ìˆ˜ë½í•˜ëŠ” ë””í´íŠ¸ í—¤ë”')` ğŸ‘‰ `'/'`ë¡œ ì„¤ì •í•˜ê²Œ ë˜ë©´ ì´ë¯¸ ì‹¤í–‰ì¤‘ì¸í˜¸
  ìŠ¤íŠ¸ë¥¼ ìë™ìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ ëœë‹¤
- `writeHead`

```jsx
...
  if (url === '/message' && method === 'POST') {
    fs.writeFileSync('message.txt', 'DUMMY');
    res.statusCode = 302;
    res.setHeader('Location', '/'); // setHeader('ìœ„ì¹˜ì§€ì •', ë¸Œë¼ìš°ì €ê°€ ìˆ˜ë½í•˜ëŠ” ë””í´íŠ¸ í—¤ë”')
    // res.writeHead('Location'); // í•œë²ˆì— ì—¬ëŸ¬ê°€ì§€ ë©”íƒ€ì •ë³´ë¥¼ ì‘ì„±í• ìˆ˜ìˆê²Œí•œë‹¤, ìƒíƒœì½”ë“œ 302
    return res.end();
  }
  res.setHeader('Content-Type', 'text/html');
  res.write('<html>');
  res.write('<head><title>My First Page</title></head>');
  res.write('<bode><h1>server start</h1></bode>');
  res.write('</html>');
```

## ğŸ”„ Streams & Buffers

```jsx
...

if (url === '/message' && method === 'POST') {
  const body = [];
  req.on('data', (chunk) => {
    console.log(chunk);
    body.push(chunk);
  }); // íŠ¹ì • ì´ë²¤íŠ¸ë¥¼ ë“¤ì„ ìˆ˜ ìˆìŒ -> ë°ì´í„° ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ëŠ” ë°ì— ë²„í¼ê°€ ë„ì›€ì„ ì¤€ë‹¤
  req.on('end', () => {
    // ë²„í¼ ì‚¬ìš© : ì²­í¬ë¥¼ ë°›ì€ í›„ ë‹¤ë£¨ê¸° ìœ„í•´ì„œ / Buffer : ì „ì—­ì—ì„œ ì‚¬ìš© ê°€ëŠ¥
    const parsedBody = Buffer.concat(body).toString();
    const message = parsedBody.split('=')[1];
    fs.writeFileSync('message.txt', message);
  });
  res.statusCode = 302; // ì‘ë‹µ ë°œìƒì´ ëë‚œí›„ì—ë„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” ê³„ì† ì‹¤í–‰ëœë‹¤
  res.setHeader('Location', '/'); // setHeader('ìœ„ì¹˜ì§€ì •', ë¸Œë¼ìš°ì €ê°€ ìˆ˜ë½í•˜ëŠ” ë””í´íŠ¸ í—¤ë”')
  // res.writeHead('Location'); // í•œë²ˆì— ì—¬ëŸ¬ê°€ì§€ ë©”íƒ€ì •ë³´ë¥¼ ì‘ì„±í• ìˆ˜ìˆê²Œí•œë‹¤, ìƒíƒœì½”ë“œ 302
  return res.end();
}
```

### â­ Stream

> ì§€ì†ì ì¸ í”„ë¡œì„¸ìŠ¤ : ë…¸ë“œê°€ ìš”ì²­ì„ í•œ ì²­í¬ì”© ë‹¤ ì½ê³ ë‚˜ì„œ, ìš”ì²­ ì „ì²´ë¥¼ ì½ê¸°ê¹Œì§€ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³ ë„ ê°ê°
> ì˜ ì²­í¬ë¥¼ ë‹¤ë£° ìˆ˜ ìˆìŒ.
>
> ì¦‰, **ë°ì´í„°ê°€ ë“¤ì–´ì˜¤ëŠ” ì™€ì¤‘ì—ë„ ì•±ì´ ì‹¤í–‰ë˜ëŠ” í•˜ë“œë“œë¼ì´ë¸Œë‚˜ ë…¸ë“œì•±ì´ ì‹¤í–‰ë˜ëŠ” ì„œë²„ì— ì“¸ ìˆ˜ ìˆìŒ
> .**

Node.jsëŠ” ë‹¤ ì´ëŸ°ì‹ìœ¼ë¡œ ì²˜ë¦¬ : ë°ì´í„°ëŠ” ë¯¸ë¦¬ ë‹¤ë£° ìˆ˜ ìˆìœ¼ë‚˜, ì²­í¬ëŠ” ë§ˆìŒëŒ€ë¡œ ë‹¤ë£° ìˆ˜ ì—†ìŒ!

### ğŸšŒ Buffers

> ì²­í¬ë¥¼ ì²´ê³„í™” í•˜ê¸° ìœ„í•´ ì‚¬ìš©! ë²„ì •ì´ë‘ ë¹„ìŠ·í•˜ë‹¤~
>
> ì—¬ëŸ¬ê°œì˜ ì²­í¬ë¥¼ ë³´ìœ í•˜ê³  íŒŒì‹±ì´ ëë‚˜ê¸° ì „ì— ì‘ì—… í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤

## ğŸ¥³ ì´ë²¤íŠ¸ ê¸°ë°˜ ì½”ë“œ ì‹¤í–‰ì˜ ëŒ€í•œ ì´í•´(`on`, `createServer`)

> Node.jsëŠ” í•¨ìˆ˜ë¥¼ í•¨ìˆ˜ì•ˆì— ë„£ìœ¼ë©´, ì•ˆì— ë„£ì€ í•¨ìˆ˜ë¥¼ ë‚˜ì¤‘ì— ì‹¤í–‰! (ë¹„ë™ê¸°)

1. ì‘ë‹µ ë°œì†¡ì€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì‹¤í–‰ì´ ëë‚¬ë‹¤ëŠ” ì˜ë¯¸ê°€ ì•„ë‹ˆë‹¤! **ì‘ë‹µì´ ë°œì†¡ëœ í›„ì—ë„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ”ê³„
   ì† ë°œìƒ**

```jsx
req.on('end', () => {
  const parsedBody = Buffer.concat(body).toString();
  const message = parsedBody.split('=')[1];
  fs.writeFileSync('message.txt', message);
});
```

2. ë™ì‹œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆì˜ ì‘ë‹µì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆëŠ” ì–´ë– í•œ ì²˜ë¦¬ë¥¼ í•˜ëŠ”ê±´ ì˜ëª»ëœ ì„¤ì • ğŸ‘‰ 1ï¸âƒ£ ì‘ë‹µì½”ë“œë¥¼
   ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì•ˆì— ë„£ì–´ì•¼í•œë‹¤

```jsx
// 1ï¸âƒ£ ì‘ë‹µì½”ë“œë¥¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì•ˆì— ë„£ê¸°
req.on('end', () => {
  const parsedBody = Buffer.concat(body).toString();
  const message = parsedBody.split('=')[1];
  fs.writeFileSync('message.txt', message);

  res.statusCode = 302;
  res.setHeader('Location', '/');
  return res.end();
});
```

3. ë¹„ë™ê¸° í•¨ìˆ˜ì¼ë•Œì—ëŠ” Node.jsê°€ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ë°”ë¡œ ì‹¤í–‰í•˜ì§€ ì•Šê³  ì½”ë“œë¥¼ ì²˜ìŒ ì ‘í–‡ì„ë•Œ ë‚´ë¶€ì ìœ¼ë¡œ ì´ë²¤
   íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ í•˜ë‚˜ ì¶”ê°€í•œë‹¤. (Node.jsëŠ” ëª¨ë“  ë¦¬ìŠ¤ë„ˆë“¤ì„ ë‚´ë¶€ì ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤.)

   ```jsx
   // ì´ê²½ìš°ì—ëŠ” req.onì˜ end ì´ë²¤íŠ¸ê°€ ìë™ìœ¼ë¡œ ì‹¤í–‰
   req.on('end', () => {
      ...
   })
   ```

4. ì‹¤í–‰ ì™„ë£Œ í›„ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ëŒ€ì‹  í˜¸ì¶œí•´ì¤Œ (Node.jsì— ì´ë²¤íŠ¸ì™€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ì íŒ ëª…ë¶€ê°€ ìˆë‹¤!!) ìœ„
   ì½”ë“œì˜ ì½œë°±í•¨ìˆ˜ê°€ ë¦¬ìŠ¤ë„ˆë¼ê³  ìƒê°í•˜ë©´ í¸í•˜ë‹¤!

5. Node.jsê°€ ìš”ì²­ ë¶„ì„ì„ ì™„ë£Œí•œ í›„, ëª…ë¶€(registry)ë¥¼ ë³´ë©´ì„œ "ìš”ì²­ì„ ë‹¤ ì²˜ë¦¬ í–ˆìœ¼ë‹ˆ ì´ì œ `end` ì´ë²¤íŠ¸
   ë¥¼ ë°œì†¡í•˜ë ¤ë©´ ì´ë²¤íŠ¸ì˜ ë¦¬ìŠ¤ë„ˆë¥¼ ë´ì•¼ê² ë‹¤!!" ë¼ê³  ìƒê°í•´ì„œ (ìœ„ì˜ ê²½ìš°ì—ì„œëŠ”)**ì½œë°±í•¨ìˆ˜**ì™€ ë“±ë¡í–ˆ
   ë˜ **ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œ**

```markdown
ë°˜í™˜ ì‘ë‹µ : 1ï¸âƒ£ `if(url === '/message' && method === 'POST')`ì„ ì´ í•¨ìˆ˜ : `return res.end()`ë¡œ ì˜®ê¸´ê²½
ìš°

1. (1ï¸âƒ£ ifë¬¸)ì— ë„ë‹¬í•´ì„œ ì¡°ê±´ì´ ë§ëŠ”ë‹¤ë©´ ê·¸ ì•ˆìœ¼ë¡œ ë“¤ì–´ê°
2. ë‘ í•¸ë“¤ëŸ¬ë¥¼ ë“±ë¡ `req.on('data',...)`, `req.on('end',...)` : ì´ ë‘ í•¨ìˆ˜ë¥¼ ë°”ë¡œ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
3. í•¨ìˆ˜ê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì´ë²¤íŠ¸ ì´ë¯¸í„°ì— ë“±ë¡
4. ë°”ë¡œ ë‹¤ìŒ ì¤„ë¡œ ë„˜ì–´ê°

## ğŸ”œ ì´ëŸ° ì„¤ì •ì´ ì¤‘ìš”í•œ ì´ìœ 

â­ Node.jsê°€ íŒŒì¼ ì‘ì„±ì™„ë£Œ ì „ê¹Œì§€ ë©ˆì¶”ëŠ”ë° ê·¸ëŸ¬ë©´ ì„œë²„ê°€ ëŠë ¤ì§€ê³  ì™„ë£Œë˜ê¸° ì „ê¹Œì§€ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ í¬
í•¨í•´ ì•„ë¬´ê²ƒë„ í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸!!!
```

6. ê²°ë¡ !!!  
   í•˜ë‹¨ ì½”ë“œì— ë„ˆë¬´ ë¹¨ë¦¬ ë„ë‹¬í•˜ì§€ ì•Šê²Œ `return`ì„ ë¶™ì—¬ì„œ ë¨¼ì € ì‹¤í–‰ë˜ë„ë¡ í•œë‹¤!!!! (í•˜ë‹¨ì½”ë“œëŠ” ì‹¤í–‰ì•ˆ
   ë¨ã…‹)

```jsx
{
  ...
  ...
  return req.on('end', () => {
    // ë²„í¼ ì‚¬ìš© : ì²­í¬ë¥¼ ë°›ì€ í›„ ë‹¤ë£¨ê¸° ìœ„í•´ì„œ / Buffer : ì „ì—­ì—ì„œ ì‚¬ìš© ê°€ëŠ¥
    const parsedBody = Buffer.concat(body).toString();
    const message = parsedBody.split('=')[1];
    // writeFIleSync : ì½”ë“œ ì‹¤í–‰ì„ ë§‰ëŠ” ë©”ì„œë“œ (íŒŒì¼ì´ ì™„ë£Œë ë•Œê¹Œì§€ ë‹¤ìŒ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì§€ ì•ŠëŠ” ë™ê¸°í™” ëª¨ë“œ)
    fs.writeFileSync('message.txt', message);

    res.statusCode = 302;
    res.setHeader('Location', '/'); // setHeader('ìœ„ì¹˜ì§€ì •', ë¸Œë¼ìš°ì €ê°€ ìˆ˜ë½í•˜ëŠ” ë””í´íŠ¸ í—¤ë”')
    return res.end();
  });

  res.setHeader('Content-Type', 'text/html');
  res.write('<html>');
  res.write('<head><title>My First Page</title></head>');
  res.write('<bode><h1>server start</h1></bode>');
  res.write('</html>');
  res.end();
}
```

`writeFileSync` : ì½”ë“œ ì‹¤í–‰ì„ ë§‰ëŠ” ë©”ì„œë“œ (íŒŒì¼ì´ ì™„ë£Œë ë•Œê¹Œì§€ ë‹¤ìŒ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì§€ ì•ŠëŠ” ë™ê¸°í™” ëª¨ë“œ
)

```

```
